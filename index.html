<!DOCTYPE html>
<html lang="en" class="notranslate" translate="no">

<head>
    <meta charset="utf-8">
    <meta name="google" content="notranslate" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="https://explorer.duinocoin.com/" />
    <meta name="robots" content="index, follow">
    <!-- Favicons -->
    <meta name="theme-color" content="#EE5A24">
    <meta name="msapplication-TileColor" content="#da532c">
    <link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-touch-icon.png?v=3">
    <link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png?v=3">
    <link rel="icon" type="image/png" sizes="16x16" href="favicons/favicon-16x16.png?v=3">
    <link rel="manifest" href="favicons/site.webmanifest?v=3">
    <link rel="mask-icon" href="favicons/safari-pinned-tab.svg?v=3" color="#5bbad5">
    <link rel="shortcut icon" href="favicons/favicon.ico?v=3">
    <!-- Primary Meta Tags -->
    <title>Duino-Coin network statistics and chain explorer</title>
    <meta name="title" content="Duino-Coin network statistics and chain explorer">
    <meta name="description" content="View real-time statistics of the Duino-Coin network and browse through the blockchain.">
    <meta name="keywords" content="duino, duinocoin, arduino, crypto, mining, blockchain, cryptocurrency">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://explorer.duinocoin.com/">
    <meta property="og:title" content="Duino-Coin network statistics and chain explorer">
    <meta property="og:description" content="View real-time statistics of the Duino-Coin network and browse through the blockchain.">
    <meta property="og:image" content="/assets/explorer.png">
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://explorer.duinocoin.com/">
    <meta property="twitter:title" content="Duino-Coin network statistics and chain explorer">
    <meta property="twitter:description" content="View real-time statistics of the Duino-Coin network and browse through the blockchain.">
    <!-- CSS -->
    <link rel="preload" href="assets/mystyles.css" as="style">
    <link rel="stylesheet" type="text/css" href="assets/mystyles.css">
    <!-- Jquery and FA -->
    <link rel="preload" href="assets/fontawesome.js" as="script">
    <script src="assets/fontawesome.js"></script>
    <link rel="preload" href="assets/jquery.min.js" as="script">
    <script src="assets/jquery.min.js"></script>
    <!-- Others -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.8.1/lottie.min.js" as="script">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.8.1/lottie.min.js"></script>
    <style>
        a>figure {
        transition: 0.2s all;
    }

    a>figure:hover {
        transform: scale(1.1);
    }

    .navbar-item:hover {
        color: #ff9f43;
    }

    .button:hover:not(.workers) {
        transform: scale(1.1);
    }

    #transactionstext1 {
        overflow-wrap: break-word;
    }

    #wavecontainer {
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center
    }

    #waveduco {
        height: 12rem;
        color: white;
        z-index: 1;
        position: absolute;
        display: table;
        margin: 0 auto;
        animation: scale 2.73s ease-in-out infinite;
    }

    #devices {
        transition: opacity 0.5s;
    }

    .hide {
        opacity: 0 !important;
    }

    @keyframes scale {
        0% {
            transform: scale(1.3);
        }

        30% {
            transform: scale(0.9);
        }

        85% {
            transform: scale(1.3);
        }

        100% {
            transform: scale(1.3);
        }
    }
        @import url('https://cdn.jsdelivr.net/npm/@creativebulma/bulma-divider@1.1.0/dist/bulma-divider.min.css');
        #transactionstext4,
        #transactionstext3 {
            overflow: hidden;
        }

        #transactionstext4:before,
        #transactionstext3:before {
            content: "";
            position: absolute;
            bottom: 0;
            right: 0;
            pointer-events: none;
            height: 10em;
            width: 7.5%;
            background: linear-gradient(90deg, rgba(0, 0, 0, 0), #070707);
        }

        #transactionstext3:before {
            right: 50%;
        }

        @media (prefers-color-scheme: light) {
            #transactionstext4:before,
            #transactionstext3:before {
                background: linear-gradient(90deg, rgba(0, 0, 0, 0), #ffffff);
            }
        }

        #workers {
            max-height: 50em;
            overflow: auto;
        }

        @media (max-width: 768px) {
            #workers {
                columns: 2;
                -webkit-columns: 2;
                -moz-columns: 2;
            }
        }


        @media (min-width: 768px) {
            #workers {
                columns: 4;
                -webkit-columns: 4;
                -moz-columns: 4;
            }
        }
    </style>
</head>

<body>
    <div id="pageloader">
        <div id="loader"></div>
    </div>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item is-active" href="https://duinocoin.com">
                <img src="assets/duino.png" height="172">
            </a>
            <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar">
                <span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span>
            </a>
        </div>
        <div id="navbar" class="navbar-menu">
            <div class="navbar-start">
                <a class="navbar-item" href="https://explorer.duinocoin.com">
                    Network stats & explorer
                </a>
                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link">
                        Resources
                    </a>
                    <div class="navbar-dropdown">
                        <a class="navbar-item" href="https://github.com/revoxhere/duino-coin/blob/gh-pages/assets/whitepaper.pdf">
                            <span>
                                <i class="fa fa-fw fa-book"></i>
                                <span>Whitepaper</span>
                            </span>
                        </a>
                        <a class="navbar-item" href="https://github.com/revoxhere/duino-coin/tree/useful-tools#branding">
                            <span>
                                <i class="fa fa-fw fa-brush"></i>
                                <span>Branding</span>
                            </span>
                        </a>
                        <a class="navbar-item" href="https://github.com/revoxhere/duino-coin/tree/useful-tools">
                            <span>
                                <i class="fa fa-fw fa-code"></i>
                                <span>API docs
                                </span>
                            </span>
                        </a>
                        <a class="navbar-item" href="https://duinocoin.com/apps.html">
                            <span>
                                <i class="fa fa-fw fa-check"></i>
                                <span>Apps and faucets</span>
                            </span>
                        </a>
                    </div>
                </div>
                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link">
                        Duino team
                    </a>
                    <div class="navbar-dropdown">
                        <a class="navbar-item" href="https://duinocoin.com/team.html">
                            <span>
                                <i class="fa fa-fw fa-users"></i>
                                <span>Meet our team</span>
                            </span>
                        </a>
                        <a class="navbar-item" href="https://duinocoin.com/donate.html">
                            <span>
                                <i class="fa fa-fw fa-heart"></i>
                                <span>Donate</span>
                            </span>
                        </a>
                        <a class="navbar-item" href="https://store.duinocoin.com">
                            <span>
                                <i class="fa fa-fw fa-tshirt"></i>
                                <span>Official merch</span>
                            </span>
                        </a>
                    </div>
                </div>
                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link">
                        More
                    </a>
                    <div class="navbar-dropdown">
                        <a class="navbar-item" href="https://duinocoin.com/contact.html">
                            <span>
                                <i class="fa fa-fw fa-envelope"></i>
                                <span>Contact us</span>
                            </span>
                        </a>
                        <a class="navbar-item" href="https://duinocoin.com/legal.html">
                            <span>
                                <i class="fa fa-fw fa-balance-scale"></i>
                                <span>Terms of service</span>
                            </span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="navbar-end is-hidden-touch">
            <a class="navbar-item" href="https://twitter.com/DuinoCoin/">
                <i class="fab fa-lg fa-twitter"></i>
            </a>
            <a class="navbar-item" href="https://www.reddit.com/r/Duinocoin/">
                <i class="fab fa-lg fa-reddit"></i>
            </a>
            <a class="navbar-item" href="https://discord.gg/kvBkccy">
                <i class="fab fa-lg fa-discord"></i>
            </a>
            <a class="navbar-item" href="https://github.com/revoxhere/duino-coin">
                <i class="fab fa-lg fa-github"></i>
            </a>
            <div class="navbar-item">
                <div class="buttons">
                    <a class="button is-primary" href="https://duinocoin.com/getting-started.html">
                        <strong>Get started</strong>
                    </a>
                </div>
            </div>
        </div>
    </nav>
    <section class="section">
        <div class="container">
            <!-- STATISTICS -->
            <div class="panel mt-nav" style="overflow:hidden">
                <p class="panel-heading heading is-size-5">
                    <span style="color:#ff7a3e">Live</span> Duino network statistics
                </p>
                <div>
                    <div class="columns is-mobile is-multiline" style="margin:auto !important">
                        <div class="column">
                            <div class="level-item has-text-centered">
                                <div>
                                    <canvas id="hashratechart" height="50em" width="100em"></canvas>
                                    <p class="title" id="hashrate">
                                        Please wait
                                    </p>
                                    <p class="heading is-size-6">
                                        Net hashrate
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="column">
                            <div class="level-item has-text-centered">
                                <div>
                                    <canvas id="userchart" height="50em" width="100em"></canvas>
                                    <p class="title" id="registeredusers">
                                        Please wait
                                    </p>
                                    <p class="heading is-size-6">
                                        Users
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="column">
                            <div class="level-item has-text-centered">
                                <div>
                                    <canvas id="circulationchart" height="50em" width="100em"></canvas>
                                    <p class="title" id="allmined">
                                        Please wait
                                    </p>
                                    <p class="heading is-size-6">
                                        DUCO in circulation
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="column">
                            <div class="level-item has-text-centered">
                                <div>
                                    <canvas id="energychart" height="50em" width="100em"></canvas>
                                    <p class="title" id="watt_usage">
                                        Please wait
                                    </p>
                                    <p class="heading is-size-6">
                                        Net energy usage
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="column">
                            <div class="level-item has-text-centered">
                                <div>
                                    <canvas id="sharechart" height="50em" width="100em"></canvas>
                                    <p class="title" id="shares">
                                        Please wait
                                    </p>
                                    <p class="heading is-size-6">
                                        Mined shares
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="columns is-multiline m-3">
                        <div class="column is-one-third">
                            <p class="heading has-text-centered is-size-5">
                                <u>Estimated</u> price
                            </p>
                            <canvas id="pricechart"></canvas>
                        </div>
                        <div class="column is-one-third">
                            <p class="heading has-text-centered is-size-5">
                                DEVICE DISTRIBUTION (<span id="totaldevices">0</span>)
                            </p>
                            <canvas id="distributionchart"></canvas>
                        </div>
                        <div class="column is-one-third">
                            <p class="heading has-text-centered is-size-5">
                                Balance distribution
                            </p>
                            <canvas id="userducochart"></canvas>
                        </div>
                        <div class="column is-half">
                            <p class="heading has-text-centered is-size-5">
                                Daily new users
                            </p>
                            <canvas id="dailyusers"></canvas>
                        </div>
                        <div class="column is-half">
                            <p class="heading has-text-centered is-size-5">
                                Daily hashrate and miners
                            </p>
                            <canvas id="minercharts"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="columns is-multiline">
                <div class="column is-half">
                    <!-- EXPLORER -->
                    <form class="panel">
                        <p class="panel-heading heading is-size-5">
                            Chain explorer
                        </p>
                        <div class="container m-3">
                            <div class="field has-addons">
                                <p class="control is-expanded" id="searchcontrol">
                                    <input class="input ducoinput" id="search_input" type="text" placeholder="e.g. coinexchange" name="search">
                                </p>
                                <p class="control">
                                    <a onclick="button_search()" class="button is-search">
                                        Search
                                    </a>
                                </p>
                            </div>
                            <p class="is-size-5" id="transactionstext1">
                                Enter something in the search box above to search through the chain<br>
                                <p class="content" id="transactionstext1_sub">
                                    You can search by Duino usernames, transaction hash IDs and block hashes.
                                    The explorer will display all known information about searched query.<br>
                                    Latest blocks and transactions are announced by the masternode and can be accessed by the links below.
                                </p>
                            </p>
                            <p class="is-size-6" id="transactionstext2"></p>
                        </div>
                        <div class="container m-3">
                            <div class="columns is-mobile">
                                <div class="column is-half">
                                    <div class="divider">Last transactions</div>
                                    <p class="is-size-6 is-size-6" id="transactionstext3">
                                        <span>Fetching data</span>
                                        <i class="fa fa-spin fa-circle-notch"></i>
                                    </p>
                                </div>
                                <div class="column is-half">
                                    <div class="divider">Last blocks</div>
                                    <p class="is-size-6 is-size-6" id="transactionstext4">
                                        <span>Fetching data</span>
                                        <i class="fa fa-spin fa-circle-notch"></i>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </form>

                    <!-- ACTIVE WORKERS -->
                    <div class="panel">
                        <div class="panel-heading">
                            <p class="heading is-size-5">
                                Active workers (<span id="workercount">?</span>)
                            </p>
                            <div class="columns is-multiline mt-1 is-mobile">
                                <div class="column is-narrow">
                                    <p class="is-size-6 has-text-grey">
                                        <i class="fa fa-circle has-text-danger"></i>
                                        unverified account
                                    </p>
                                </div>
                                <div class="column is-narrow">
                                    <p class="is-size-6 has-text-grey">
                                        <i class="fa fa-circle has-text-success"></i>
                                        verified account
                                    </p>
                                </div>
                                <div class="column is-narrow">
                                    <p class="is-size-6 has-text-grey">
                                        <span class="tag">1</span>
                                        amount of workers
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="panel-block">
                            <p id="workers" class="is-size-6 is-size-6">
                                <button id="loadworkers" class="button workers" onclick="fill_worker_list()">
                                    Load all workers (it may take a while)
                                </button>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="column is-half">
                    <!-- NODES -->
                    <div id="pools" class="columns is-mobile is-multiline">
                        <div class="column">
                            <div class="panel">
                                <p class="panel-heading heading">Common services</p>
                                <div class="content m-3">
                                    <div class="columns is-multiline">
                                        <div class="content m-3" style="min-width:200px">
                                            <p class="heading title mb-1 is-size-6">
                                                <i class="fa fa-link"></i>
                                                Websites
                                            </p>
                                            <div class="content">
                                                Operational <i class="fa fa-check-circle has-text-success"></i><br>
                                                with <b class="icon-text" style="color:#F48121">
                                                    <img class="icon" src='https://upload.wikimedia.org/wikipedia/commons/9/94/Cloudflare_Logo.png'>

                                                    <span>Cloudflare</span>
                                                </b>
                                            </div>
                                            <p class="heading title mb-1 is-size-6">
                                                <i class="fa fa-cog"></i>
                                                APIs
                                            </p>
                                            <div class="content has-text-weight-bold">
                                                Possible problems <i class="fa fa-times-circle has-text-danger"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="panel">
                                <p class="panel-heading heading">Servers</p>
                                <div class="content m-3">
                                    <div class="columns is-multiline">
                                        <div class="content m-3" style="min-width:200px">
                                            Fetching data...
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    </div>
    <!-- FOOTER -->
    <footer class="footer">
        <div class="content has-text-centered">
            <p>
                <strong>Duino-Coin Stats</strong> by <strong>the Duino team</strong> 2019-2025
                <br>This page is open-source. You can improve it <a href="https://github.com/revoxhere/duco-statistics">here</a>
            </p>
        </div>
    </footer>
</body>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/emn178/chartjs-plugin-labels/src/chartjs-plugin-labels.js"></script>
<script src="https://bernii.github.io/gauge.js/dist/gauge.min.js"></script>
<script>
const pageloader = document.getElementById('loader');
let duco_price = 0.00045;
let load_workers = false;
let url_string = window.location;
let url = new URL(url_string);
let to_search = url.searchParams.get("search");

function change_tags(data, type) {
    $("meta[name='title']").attr(`${type}: ${data} - browse the official Duino-Coin explorer`);
    $("meta[name='og:title']").attr(`${type}: ${data} - browse the official Duino-Coin explorer`);
    $("meta[name='twitter:title']").attr(`${type}: ${data} - browse the official Duino-Coin explorer`);

    $("meta[name='description']").attr(`View details of ${type}: ${data} in the official Duino-Coin chain explorer.`);
    $("meta[name='og:description']").attr(`View details of ${type}: ${data} in the official Duino-Coin chain explorer.`);
    $("meta[name='twitter:description']").attr(`View details of ${type}: ${data} in the official Duino-Coin chain explorer.`);
}

bodymovin.loadAnimation({
    wrapper: pageloader,
    animType: 'svg',
    autoplay: true,
    loop: true,
    path: 'assets/loader.json'
});


function update_element(element, value, animate = false) {
    if (animate) {
        $(`#${element}`).fadeOut('fast', function() {
            $(`#${element}`).html(value).fadeIn('fast');
        });
    } else {
        $(`#${element}`).html(value);
    }
}


function round_to(precision, value) {
    power_of_ten = 10 ** precision;
    return Math.round(value * power_of_ten) / power_of_ten;
}


function fill_worker_list() {
    $("#loadworkers").addClass("is-loading")
    fetch("https://server.duinocoin.com/statistics_miners")
        .catch(function(error) {
            console.log(error);
        })
        .then(response => response.json())
        .then(data => {
            data = data.result;
            let workers = `<ul class="workers">`
            let counter = 0;
            let worker_counter = 0;
            let sorted_workers = [];
            for (worker in data) {
                sorted_workers.push({
                    "User": worker,
                    "Verified": data[worker]["v"],
                    "Miners": data[worker]["w"]
                })
            }
            sorted_workers.sort((a, b) => b.Miners - a.Miners);
            for (let i = 0; i < sorted_workers.length; i++) {
                let worker = sorted_workers[i];

                if (worker.Verified == "yes") {
                    workers +=
                        `<li>
                                  <a class="has-text-success" onclick="link_search('${worker.User}')">` +
                        worker.User +
                        `</a><b class="tag">` +
                        worker.Miners +
                        `</b></li>`;
                } else {
                    workers +=
                        `<li>
                                  <a class="has-text-danger" onclick="link_search('${worker.User}')">` +
                        worker.User +
                        `</a>
                        <b class="tag">` +
                        worker.Miners +
                        `</b></li>`;
                }

                worker_counter += worker.Miners;
                counter++;
            }
            workers += `</ul>`;
            document.getElementById("workers").innerHTML = workers;
            $("#allworkers").text("(" + worker_counter + " workers on " + counter + " accounts)");
        });
}


const scientific_prefix = (value) => {
    value = parseFloat(value);
    if (value / 1000000 > 0.5)
        value = round_to(4, value / 1000000) + " M";
    else if (value / 1000 > 0.5)
        value = round_to(4, value / 1000) + " k";
    else
        value = round_to(4, value) + " ";
    return value;
};
firststart = true;

let opts = {
    angle: 0,
    lineWidth: 0.5,
    radiusScale: 1,
    pointer: { strokeWidth: 0 },
    limitMax: false,
    limitMin: true,
    colorStart: '#EF7A44',
    generateGradient: false,
    highDpiSupport: true,
};

var target = document.getElementById('hashratechart');
let hashrate_gauge = new Gauge(target).setOptions(opts);
hashrate_gauge.maxValue = 5000;
hashrate_gauge.setMinValue(0);
hashrate_gauge.animationSpeed = 100;

var target = document.getElementById('userchart');
let user_gauge = new Gauge(target).setOptions(opts);
user_gauge.maxValue = 125000;
user_gauge.setMinValue(0);
user_gauge.animationSpeed = 100;

var target = document.getElementById('circulationchart');
let circulation_gauge = new Gauge(target).setOptions(opts);
circulation_gauge.maxValue = 2811000000;
circulation_gauge.setMinValue(0);
circulation_gauge.animationSpeed = 100;

var target = document.getElementById('energychart');
let energy_gauge = new Gauge(target).setOptions(opts);
energy_gauge.maxValue = 100;
energy_gauge.setMinValue(0);
energy_gauge.animationSpeed = 100;

var target = document.getElementById('sharechart');
let share_gauge = new Gauge(target).setOptions(opts);
share_gauge.maxValue = 3500000000000;
share_gauge.setMinValue(0);
share_gauge.animationSpeed = 100;

master_server = {}


function fetch_price() {
    fetch("https://server.duinocoin.com/historic_prices?currency=max&limit=30")
        .catch(function(error) {
            console.log(error);
        })
        .then(response => response.json())
        .then(data => {
            data = data.result;

            let date_labels = []
            let prices = []

            for (day in data.reverse()) {
                date_labels.push(data[day]["day"]);
                prices.push(data[day]["price"])
            }

            var ctx = document.getElementById('pricechart').getContext('2d');
            var myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: date_labels,
                    datasets: [{
                        label: '',
                        data: prices,
                        backgroundColor: 'rgba(239, 122, 68, 0.8)',
                        borderColor: 'rgba(255, 255, 255, 1)',
                        borderWidth: 1.5
                    }]
                },
                options: {
                    legend: {
                        display: false
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                callback: function(value, index, values) {
                                    return '$' + value.toFixed(5);
                                },
                                beginAtZero: true
                            }
                        }],
                        xAxes: [{
                            gridLines: {
                                display: false
                            }
                        }]

                    }
                }
            });

        });
}

function get_daily() {
    fetch("https://server.duinocoin.com/historic_data?limit=14")
        .catch(function(error) {
            console.log(error);
        })
        .then(response => response.json())
        .then(data => {
            data = data.result;
            days = []
            users = []

            hashrate_daily = []
            workers_daily = []
            for (day in data.reverse()) {
                try {
                    if (data[day]["users"] - data[day - 1]["users"] >= 0) {
                        users.push(data[day]["users"] - data[day - 1]["users"]);
                    } else {
                        users.push(10);
                    }
                    hashrate_daily.push(parseFloat(data[day]["hashrate"].replace(" GH/s", "")))
                    workers_daily.push(data[day]["miners"])
                    days.push(data[day]["day"]);
                } catch (err) {}
            }

            const ctxt = document.getElementById('dailyusers').getContext('2d');
            const dailyusers = new Chart(ctxt, {
                type: 'bar',
                data: {
                    labels: days,
                    datasets: [{
                        data: users,
                        backgroundColor: '#00C07B',
                        borderWidth: 1.5
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }],
                    },
                    animation: {
                        duration: 1500
                    },
                    legend: {
                        display: false
                    },
                    plugins: {
                        labels: {
                            fontSize: 0,
                        }
                    }
                }
            });
            console.log(workers_daily)
            const ctxtx = document.getElementById('minercharts').getContext('2d');
            const minercharts = new Chart(ctxtx, {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        yAxisID: 'A',
                        label: 'Net hashrate [GH/s]',
                        data: hashrate_daily,
                        backgroundColor: '#3498db88',
                    }, {
                        yAxisID: 'B',
                        label: 'Active workers',
                        data: workers_daily,
                        backgroundColor: '#e67e2288',
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        yAxes: [{
                                id: 'A',
                                type: 'linear',
                                position: 'right',
                                ticks: { beginAtZero: true },
                                grid: { display: false }
                            },
                            {
                                id: 'B',
                                type: 'linear',
                                position: 'left',
                                ticks: { beginAtZero: true },
                                grid: { display: false }
                            }
                        ],
                    },
                    animation: {
                        duration: 1500
                    },
                    legend: {
                        display: true
                    },
                    plugins: {
                        labels: {
                            fontSize: 0
                        }
                    }
                }
            });
        });
}
get_daily()

webminer_proxy = "wait";
closed_by_client = false;

function update_ws_proxy() {
    start_time = new Date();
    const exampleSocket = new WebSocket(
      "wss://magi.duinocoin.com:8443/", "wss"
    );
    exampleSocket.onmessage = (event) => {
      if(event.data.includes(".")) {
        webminer_ping = new Date() - start_time;
        closed_by_client = true;
        exampleSocket.close();
        webminer_proxy = "ok";
      }
    };
    exampleSocket.addEventListener("close", (event) => {
        if (!closed_by_client) webminer_proxy = "down";
        closed_by_client = false;
    });
}

function update_stats() {
    fetch("https://server.duinocoin.com/api.json")
        .catch(function(error) {
            console.log(error);
        })
        .then(response => response.json())
        .then(data => {
            duco_price = data["Duco price"];

            data["Miner distribution"]["ESP32"] /= 2
            data["Miner distribution"]["RPi"] /= 4
            data["Miner distribution"]["CPU"] /= 4
            data["Miner distribution"]["Web"] /= 3

            update_element("hashrate", data["DUCO-S1 hashrate"])
            hashrate_gauge.set(parseInt(data["Pool hashrate"]));

            update_element("registeredusers", data["Registered users"])
            user_gauge.set(data["Registered users"]);

            update_element("allmined", scientific_prefix(data["All-time mined DUCO"]));
            circulation_gauge.set(data["All-time mined DUCO"])

            update_element("watt_usage", data["Net energy usage"])
            energy_gauge.set(parseInt(data["Net energy usage"]))

            update_element("shares", scientific_prefix(data["Mined blocks"]))
            share_gauge.set(parseInt(data["Mined blocks"]))

            update_element("arduinos", data["Miner distribution"]["Arduino"])

            update_element("esp8266s", data["Miner distribution"]["ESP8266"])

            update_element("esp32s", Math.round(data["Miner distribution"]["ESP32"]))

            update_element("rpis", Math.round(data["Miner distribution"]["RPi"]))

            update_element("cpus", Math.round(data["Miner distribution"]["Web"] +
                data["Miner distribution"]["CPU"]))

            update_element("phones", Math.round(data["Miner distribution"]["Phone"]))

            update_element("others", data["Miner distribution"]["Other"])

            aktualizacja = new Date() / 1000 - data["Last sync"]
            master_server = {
                "icon": "fa-server",
                "name": `Masternodes`,
                "cpu": data["Server CPU usage"],
                "ram": data["Server RAM usage"],
                "connections": data["Active connections"],
                "lastsync": `${round_to(0, aktualizacja)}s ago`
            }

            labels = []
            mnrdata = []
            $("#workercount").text(data["Miner distribution"]["All"])
            delete data["Miner distribution"]["All"]
            for (label in data["Miner distribution"]) {
                labels.push(label)
                mnrdata.push(Math.round(data["Miner distribution"][label]))
            }

            userlabels = []
            usrdata = []
            ignored = ["celoDUCO", "maticDUCO", "bscDUCO", "coinexchange"]
            for (label in data["Top 10 richest miners"]) {
                user = data["Top 10 richest miners"][label].split(" - ")
                if (!ignored.includes(user[1])) {
                    userlabels.push(user[1])
                    usrdata.push(parseInt(user[0]))
                }
            }
            userlabels.push("Other accounts")
            usrdata.push(parseInt(data["All-time mined DUCO"]))

            if (firststart) {
                const ctx = document.getElementById('distributionchart').getContext('2d');
                distributionchart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: mnrdata,
                            backgroundColor: [
                                '#00C07B',
                                '#5E68FF',
                                '#EE5253',
                                'rgba(253, 167, 223, 1.0)',
                                'rgba(16, 172, 132, 1.0)',
                                '#2e86de',
                                '#5f27cd',
                                'rgba(255, 159, 67, 1.0)',
                                'rgba(0, 148, 50, 1.0)',
                                '#EF7A44'
                            ],
                            borderWidth: 2.0
                        }]
                    },
                    options: {
                        rotation: 60,
                        animation: {
                            duration: 1500
                        },
                        legend: false,
                        tooltips: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            cornerRadius: 3,
                            caretSize: 0,
                            displayColors: false
                        },
                        scales: {
                            yAxes: [{
                                display: true,
                                ticks: {
                                    suggestedMin: 0,
                                    suggestedMax: Math.max(...mnrdata) + 500
                                }
                            }]
                        },
                        plugins: {
                            labels: {
                                render: "value",
                                showZero: true,
                                fontSize: 12,
                                fontColor: '#888',
                                fontStyle: 'normal',
                                fontFamily: "'Lato', 'Helvetica', 'Arial', sans-serif",
                                textShadow: true,
                                shadowBlur: 10,
                                shadowOffsetX: 1,
                                shadowOffsetY: 1,
                                shadowColor: 'rgba(255,255,255,1.0)',
                                position: 'border',
                                overlap: false,
                                textMargin: 0
                            }
                        }
                    }
                });

                const ctxt = document.getElementById('userducochart').getContext('2d');
                userchart = new Chart(ctxt, {
                    type: 'pie',
                    data: {
                        labels: userlabels,
                        datasets: [{
                            data: usrdata,
                            backgroundColor: [
                                '#00C07B',
                                '#5E68FF',
                                '#EE5253',
                                'rgba(253, 167, 223, 1.0)',
                                'rgba(16, 172, 132, 1.0)',
                                'rgba(255, 159, 67, 1.0)',
                                'rgba(0, 148, 50, 1.0)',
                                '#EF7A44'
                            ],
                            borderWidth: 1.0
                        }]
                    },
                    options: {
                        rotation: (Math.PI) - (120 / 180 * Math.PI),
                        animation: {
                            duration: 1500
                        },
                        legend: false,
                        tooltips: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            cornerRadius: 8,
                            caretSize: 0,
                            displayColors: false
                        },
                        plugins: {
                            labels: {
                                render: 'label',
                                showZero: false,
                                fontSize: 12,
                                fontColor: '#fff',
                                fontStyle: 'normal',
                                fontFamily: "'Lato', 'Helvetica', 'Arial', sans-serif",
                                textShadow: true,
                                shadowBlur: 5,
                                shadowOffsetX: 0,
                                shadowOffsetY: 0,
                                shadowColor: 'rgba(0,0,0,0.5)',
                                arc: true,
                                position: 'border',
                                overlap: false,
                                outsidePadding: 6,
                                textMargin: 6
                            }
                        }
                    }
                });
                firststart = false;
            } else {
                distributionchart.data.datasets.forEach((dataset) => {
                    dataset.data.pop();
                });
                distributionchart.data.datasets.forEach((dataset) => {
                    dataset.data = mnrdata
                });
                distributionchart.update(1);

                userchart.data.datasets.forEach((dataset) => {
                    dataset.data.pop();
                });
                userchart.data.datasets.forEach((dataset) => {
                    dataset.data = usrdata
                });
                userchart.update(1);
 
            }
            $("#totaldevices").text(mnrdata.reduce((a, b) => a + b))
        })
}


function last_explorer_hashes() {
    fetch("https://server.duinocoin.com/transactions.json")
        .catch(function(error) {})
        .then(response => response.json())
        .then(data => {

            hashes = []
            for (hash in data) {
                hashes.push(data[hash])
            }

            transaction_hashes_html = "";
            for (hash in hashes.reverse()) {
                if (hash >= 5) break
                this_hash = hashes[hash].Hash;
                if (this_hash.length == 40) {
                    transaction_hashes_html += `<a class='transaction2 monospace' onclick="link_search('${this_hash}')">` + this_hash.substring(0, 40) + "</a><br>";
                } else {
                    transaction_hashes_html += `<a class='transaction1 monospace' onclick="link_search('${this_hash}')">` + this_hash.substring(0, 40) + "</a><br>";
                }
            }
            $("#transactionstext3").html(transaction_hashes_html);
        })
    fetch("https://server.duinocoin.com/foundBlocks.json")
        .catch(function(error) {})
        .then(response => response.json())
        .then(data => {
            let last = [];
            for (hash in data) {
                last.push(hash);
            }

            block_hashes_html = "";
            for (hash in last.reverse()) {
                if (hash >= 5) break
                this_hash = last[hash];
                if (this_hash.length == 40) {
                    block_hashes_html += `<a class='block2 monospace' onclick="link_search('${this_hash}')">` + this_hash.substring(0, 40) + "</a><br>";
                } else {
                    block_hashes_html += `<a class='block1 monospace' onclick="link_search('${this_hash}')">` + this_hash.substring(0, 40) + "</a><br>";
                }
            }
            $("#transactionstext4").html(block_hashes_html);
        })
}

function get_prefix(symbol, value) {
    value = parseFloat(value);
    if (value / 1000000000 > 0.5)
        value = round_to(2, value / 1000000000) + " G" + symbol;
    else if (value / 1000000 > 0.5)
        value = round_to(2, value / 1000000) + " M" + symbol;
    else if (value / 1000 > 0.5)
        value = round_to(2, value / 1000) + " k" + symbol;
    else
        value = round_to(2, value) + " " + symbol;
    return value;
}

String.prototype.escape = function() {
    var tagsToReplace = {
        '&': ' ',
        '\\': ' ',
        '/': ' ',
        '(': ' ',
        ')': ' ',
        '`': ' ',
        '<': ' ',
        '>': ' '
    };
    return this.replace(/[&<>]/g, function(tag) {
        return tagsToReplace[tag] || tag;
    });
};

function search(searched_string) {
    let cont = true;
    if (searched_string) {
        window.history.pushState('Duino-Coin network statistics and chain explorer', 'Duino-Coin network statistics and chain explorer', `?search=${searched_string}`);
        $("#transactionstext1").html(`<div class="divider">Results&nbsp;for&nbsp;<span style="overflow:hidden"><a onclick="link_search('${searched_string}')">${searched_string}</a></span></div>`);
        $("#transactionstext1_sub").html("");
    }
    if (cont) {
        $("#searchcontrol").addClass("is-loading");
        $.getJSON("https://server.duinocoin.com/transactions/" + searched_string, function(data) {
                if (data.success == true && data.result != "No transaction found") {
                    cont = false;
                    let amount_usd = data.result.amount * duco_price;
                    if (searched_string.length == 40) transaction_type = "DUCO-S1";
                    else transaction_type = "XXHASH"

                    change_tags(searched_string, "transaction");

                    found_transaction_html = `
                            <table class="table is-narrow is-fullwidth">
                                <tbody>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-info-circle"></i>
                                                <span>Type</span> 
                                            </span>
                                        </th>
                                        <th>
                                            Transaction #${data.result.id} (${transaction_type})
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-calendar"></i>
                                                <span>Timestamp</span>
                                            </span>
                                        </th>
                                        <th>
                                            ${data.result.datetime}
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-arrow-right"></i>
                                                <span>Output (sender)</span>
                                            </span>
                                        </th>
                                        <th>
                                            <a onclick="link_search('${data.result.sender}')">
                                                ${data.result.sender}
                                            </a>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-arrow-left"></i>
                                                <span>Input (recipient)</span>
                                            </span>
                                        </th>
                                        <th>
                                            <a onclick="link_search('${data.result.recipient}')">
                                                ${data.result.recipient}
                                            </a>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-coins"></i>
                                                <span>Transferred amount</span>
                                            </span>
                                        </th>
                                        <th>
                                            ${data.result.amount} DUCO
                                            ($${round_to(4, amount_usd)})
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-envelope"></i>
                                                <span>Memo</span>
                                            </span>
                                        </th>
                                        <th style="word-break:break-all;">
                                            ${data.result.memo}
                                        </th>
                                    </tr>
                                </tbody>
                            </table>`

                    $("#searchcontrol").removeClass("is-loading");
                    update_element("transactionstext2", found_transaction_html, true);
                }
            })
            .fail(function(error) {
                console.log(error.responseText);
                if (error.responseText.includes("500")) error = "500 - internal server error";
                else if (error.responseText.includes("429")) error = "429 - too many requests (slow down)";
                else if (error.responseText.includes("404")) error = "404 - nothing interesting found";
                found_transaction_html = `<ul class="is-size-6"><li>` +
                    `<i class='fas fa-info-circle'></i>` +
                    `&nbsp;Error: <b>${error}</b> 🤦‍♀️</li></ul>`;
                $("#searchcontrol").removeClass("is-loading");
                update_element("transactionstext2", found_transaction_html, true);
            });
    }
    if (cont) {
        $.getJSON('https://server.duinocoin.com/users/' + searched_string, function(data) {
                if (data.success == true) {
                    cont = false;
                    let amount_usd = data.result.balance.balance * duco_price;

                    change_tags(searched_string, "user");

                    miner_str = "";
                    miner_count = 0;
                    if (data.result.miners.length) {
                        let threaded_miners = {};
                        user_miners = data.result.miners;

                        for (let miner in user_miners) {
                            let miner_wallet_id = user_miners[miner]["wd"];
                            if (!miner_wallet_id) miner_wallet_id = Math.random();
                            const miner_hashrate = user_miners[miner]["hashrate"];
                            const miner_rejected = user_miners[miner]["rejected"];
                            const miner_accepted = user_miners[miner]["accepted"];

                            if (!threaded_miners[miner_wallet_id]) {
                                threaded_miners[miner_wallet_id] = user_miners[miner];
                                threaded_miners[miner_wallet_id]["threads"] = 1;
                                miner_count += 1;
                                continue;
                            } else if (threaded_miners[miner_wallet_id]) {
                                threaded_miners[miner_wallet_id]["hashrate"] += miner_hashrate;
                                threaded_miners[miner_wallet_id]["rejected"] += miner_rejected;
                                threaded_miners[miner_wallet_id]["accepted"] += miner_accepted;
                                threaded_miners[miner_wallet_id]["threads"] += 1;
                                continue;
                            }
                        }

                        i = 0;
                        for (miner in threaded_miners) {
                            if (threaded_miners[miner]["identifier"] != "None") {
                                miner_str += "<b>" +
                                    threaded_miners[miner]["identifier"] +
                                    "</b> <span class='has-text-grey'>(" +
                                    threaded_miners[miner]["software"] +
                                    ")</span> - " +
                                    get_prefix("", threaded_miners[miner]["accepted"]) + "/" +
                                    get_prefix("", (threaded_miners[miner]["accepted"] + threaded_miners[miner]["rejected"])) +
                                    ", <b>" + get_prefix("H/s", threaded_miners[miner]["hashrate"]) + `</b> (${((threaded_miners[miner]["threads"] == 1) ? ("1 thread") : (`${threaded_miners[miner]["threads"]} threads`))}) <br>`;
                            } else {
                                miner_str += "<b>" + threaded_miners[miner]["software"] + "</b> - " +
                                    threaded_miners[miner]["accepted"] + "/" +
                                    (threaded_miners[miner]["accepted"] + threaded_miners[miner]["rejected"]) +
                                    ", <b>" + get_prefix("H/s", threaded_miners[miner]["hashrate"]) + `</b> (${((threaded_miners[miner]["threads"] == 1) ? ("1 thread") : (`${threaded_miners[miner]["threads"]} threads`))}) <br>`;
                            }

                            if (i > 10) {
                                miner_str += "And " + (miner_count - i) + " more miner(s)...";
                                break;
                            }
                            i += 1;
                        }
                    } else {
                        miner_str += "No miners found for that user";
                    }

                    tx_str = "";
                    i = 0;
                    if (data["result"]["transactions"].length) {
                        for (transaction in data["result"]["transactions"].reverse()) {
                            if (data["result"]["transactions"][transaction]["sender"] == data["result"]["balance"]["username"]) {
                                tx_str += "<span class='has-text-grey'>" +
                                    data["result"]["transactions"][transaction]["datetime"] +
                                    "</span> Sent <span class='has-text-danger-dark'>" +
                                    " <b>" +
                                    Math.round(data["result"]["transactions"][transaction]["amount"] * 1000) / 1000 +
                                    " DUCO</b></span> to " +
                                    `<a onclick="link_search('${data["result"]["transactions"][transaction]["recipient"]}')">` +
                                    "<b>" +
                                    data["result"]["transactions"][transaction]["recipient"] + "</a></b> " + `<a onclick="link_search('${data["result"]["transactions"][transaction]["hash"]}')">(` + data["result"]["transactions"][transaction]["hash"].substr(data["result"]["transactions"][transaction]["hash"].length - 8) + ")</a><br>"
                            } else {
                                tx_str += "<span class='has-text-grey'>" +
                                    data["result"]["transactions"][transaction]["datetime"] +
                                    "</span> Received <span class='has-text-success-dark'>" +
                                    "<b>" +
                                    Math.round(data["result"]["transactions"][transaction]["amount"] * 1000) / 1000 +
                                    " DUCO</b></span> from " +
                                    `<a onclick="link_search('${data["result"]["transactions"][transaction]["sender"]}')">` + "<b>" +
                                    data["result"]["transactions"][transaction]["sender"] + "</a></b> " + `<a onclick="link_search('${data["result"]["transactions"][transaction]["hash"]}')">(` + data["result"]["transactions"][transaction]["hash"].substr(data["result"]["transactions"][transaction]["hash"].length - 8) + ")</a><br>"
                            }

                            i += 1;
                            if (i > 10) {
                                break;
                            }
                        }
                    } else {
                        tx_str += "No transactions found for that user";
                    }

                    if (data.result.balance.last_login != 0)
                        last_login_str = new Date(data.result.balance.last_login * 1000).toLocaleString();
                    else
                        last_login_str = "before 5.03.2022";

                    if (data.result.balance.stake_date != 0)
                        stake_str = `yes - ${data.result.balance.stake_amount} DUCO (ends on ${new Date(data.result.balance.stake_date*1000).toLocaleString()})`;
                    else
                        stake_str = "no";

                    found_user_html = `
                            <table class="table is-narrow is-fullwidth">
                                <tbody>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-fw fa-user"></i>
                                                <span>Wallet name</span> 
                                            </span>
                                        </th>
                                        <th>
                                            <a onclick="link_search('${searched_string}')">
                                                ${searched_string}
                                            </a>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-fw fa-coins"></i>
                                                <span>Balance</span>
                                            </span>
                                        </th>
                                        <th>
                                            ${round_to(10, data.result.balance.balance)} DUCO
                                            ($${round_to(4, amount_usd)})
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-fw fa-check-circle"></i>
                                                <span>Verified</span>
                                            </span>
                                        </th>
                                        <th>
                                            ${data.result.balance.verified}
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-fw fa-calendar"></i>
                                                <span>Creation date</span>
                                            </span>
                                        </th>
                                        <th>
                                            ${data.result.balance.created}
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-fw fa-signal"></i>
                                                <span>Last seen</span>
                                            </span>
                                        </th>
                                        <th>
                                            ${last_login_str}
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-fw fa-layer-group"></i>
                                                <span>Staking</span>
                                            </span>
                                        </th>
                                        <th>
                                            ${stake_str}
                                        </th>
                                    </tr>
                                    <tr>
                                        <th colspan="2">
                                            <span class="icon-text">
                                                <i class="icon fa fa-fw fa-cog"></i>
                                                <span>Miners</span>
                                            </span>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th colspan="2">
                                            ${miner_str}
                                        </th>
                                    </tr>
                                    <tr>
                                        <th colspan="2">
                                            <span class="icon-text">
                                                <i class="icon fa-fw fas fa-people-arrows"></i>
                                                <span>Transactions</span>
                                            </span>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th colspan="2">
                                            ${tx_str}
                                        </th>
                                    </tr>
                                </tbody>
                            </table>`

                    $("#searchcontrol").removeClass("is-loading");
                    update_element("transactionstext2", found_user_html, true);
                }
            })
            .fail(function(error) {
                if (error.responseText.includes("500")) error = "500 - internal server error";
                else if (error.responseText.includes("429")) error = "429 - too many requests (slow down)";
                else if (error.responseText.includes("404")) error = "404 - nothing interesting found";
                found_transaction_html = `<ul class="is-size-6"><li>` +
                    `<i class='fas fa-info-circle'></i>` +
                    `&nbsp;Error: <b>${error}</b> 🤦‍♀️</li></ul>`;
                $("#searchcontrol").removeClass("is-loading");
                update_element("transactionstext2", found_transaction_html, true);
            });
    }
    if (cont) {
        $.getJSON('https://server.duinocoin.com/foundBlocks.json', function(data) {
                cont = false;
                let found = data[searched_string]
                if (searched_string != "" && found != "" && found != undefined) {
                    cont = false;
                    let amount_usd = found["Amount generated"] * duco_price;
                    if (searched_string.length == 40) block_type = "DUCO-S1";
                    else block_type = "XXHASH"

                    change_tags(searched_string, "block");

                    found["Finder"] = found["Finder"].replace("(DUCO-S1)", "")
                    found["Finder"] = found["Finder"].replace("(XXHASH)", "")

                    found_block_html = `
                            <table class="table is-fullwidth">
                                <tbody>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-info-circle"></i>
                                                <span>Type</span>
                                            </span>
                                        </th>
                                        <th>
                                            Block (${block_type})
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-calendar"></i>
                                                <span>Timestamp</span>
                                            </span>
                                        </th>
                                        <th>
                                            ${found["Date"]} ${found["Time"]}
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-user-tie"></i>
                                                <span>Finder</span>
                                            </span>
                                        </th>
                                        <th>
                                            <a onclick="link_search('${found["Finder"]}')">
                                                ${found["Finder"]}
                                            </a>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th>
                                            <span class="icon-text">
                                                <i class="icon fa fa-coins"></i>
                                                <span>Generated amount</span>
                                            </span>
                                        </th>
                                        <th>
                                            ${found["Amount generated"]} DUCO
                                            ($${round_to(4, amount_usd)})
                                        </th>
                                    </tr>
                                </tbody>
                            </table>`

                    $("#searchcontrol").removeClass("is-loading");
                    update_element("transactionstext2", found_block_html, true);
                }
            })
            .fail(function(error) {
                if (error.responseText.includes("500")) error = "500 - internal server error";
                else if (error.responseText.includes("429")) error = "429 - too many requests (slow down)";
                else if (error.responseText.includes("404")) error = "404 - nothing interesting found";
                found_transaction_html = `<ul class="is-size-6"><li>` +
                    `<i class='fas fa-info-circle'></i>` +
                    `&nbsp;Error: <b>${error}</b> 🤦‍♀️</li></ul>`;
                $("#searchcontrol").removeClass("is-loading");
                update_element("transactionstext2", found_transaction_html, true);
            });
    }
    if (cont) {
        setTimeout(function() { $("#searchcontrol").removeClass("is-loading"); }, 500);
        $("#transactionstext2").text(`Nothing interesting found for your query 🤷`);
    }
}

function getColor(value) {
    var hue = ((1 - value) * 128).toString(10);
    return ["hsl(", hue, ", 100%, 25%)"].join("");
}

function update_pools() {
    start_time = new Date();
    fetch("https://server.duinocoin.com/all_pools?v=" +new Date())
        .catch(function(error) {
            console.log(error);
        })
        .then(response => response.json())
        .then(data => {
            end_time = new Date();
            if (data.success === true) {
                data = data.result;

                node_html = "";
                eu_html = "";
                au_html = "";
                as_html = "";
                sa_html = "";
                na_html = "";
                common_html = `<div class="content m-3" style="min-width:200px">
                                    <p class="heading title mb-1 is-size-6">
                                        <i class="fa fa-link"></i>
                                        Websites
                                    </p>
                                    <div class="content">
                                        Operational <i class="fa fa-check-circle has-text-success"></i><br>
                                        with <b class="icon-text" style="color:#F48121">
                                            <img class="icon" src='https://upload.wikimedia.org/wikipedia/commons/9/94/Cloudflare_Logo.png'>

                                            <span>Cloudflare</span>
                                        </b>
                                    </div>
                                </div>
                                <div class="content m-3" style="min-width:200px">
                                    <p class="heading title mb-1 is-size-6">
                                        <i class="fa fa-cog"></i>
                                        APIs
                                    </p>
                                    <div class="content">
                                        Operational <i class="fa fa-check-circle has-text-success"></i><br>
                                        Response time: <b>${end_time - start_time}ms</b>
                                    </div>
                                </div>`;

                if (webminer_proxy == "ok") {
                    common_html += `
                                <div class="content m-3" style="min-width:200px">
                                    <p class="heading title mb-1 is-size-6">
                                        <i class="fa fa-angle-double-right"></i>
                                        Web miner proxy
                                    </p>
                                    <div class="content">
                                        Operational <i class="fa fa-check-circle has-text-success"></i><br>
                                        Response time: <b>${webminer_ping}ms</b>
                                    </div>
                                </div>`
                } else if (webminer_proxy == "wait") {
                    common_html += `
                                <div class="content m-3" style="min-width:200px">
                                    <p class="heading title mb-1 is-size-6">
                                        <i class="fa fa-angle-double-right"></i>
                                        Web miner proxy
                                    </p>
                                    <div class="content">
                                        Connecting...
                                    </div>
                                </div>`
                } else {
                    common_html += `
                                <div class="content m-3" style="min-width:200px">
                                    <p class="heading title mb-1 is-size-6">
                                        <i class="fa fa-angle-double-right"></i>
                                        Web miner proxy
                                    </p>
                                    <div class="content has-text-weight-bold">
                                        Possible problems <i class="fa fa-times-circle has-text-danger"></i><br>
                                    </div>
                                </div>`
                }

                data = {
                    "master": master_server,
                    ...data
                }
                for (node in data) {
                    cpucolor = getColor(data[node]["cpu"] / 100);
                    ramcolor = getColor(data[node]["ram"] / 100);

                    node_type = data[node]["type"];
                    if (node_type == "Official") {
                        node_type = `<span class="tag is-success">${node_type}</span>`
                    } else if (node_type) {
                        node_type = `<span class="tag is-primary">${node_type}</span>`
                    } else {
                        node_type = ``;
                    }

                    if (parseInt(data[node]["lastsync"]) < 20) {
                        synccolor = "has-text-success";
                        syncicon = "fa-check-circle";
                        sync_text = "Operational";
                    } else if (parseInt(data[node]["lastsync"]) < 360) {
                        synccolor = "has-text-warning";
                        syncicon = "fa-exclamation-triangle";
                        sync_text = `Last sync: <strong>${data[node]["lastsync"]}</strong>`;
                    } else {
                        synccolor = "has-text-danger";
                        syncicon = "fa-times-circle";
                        sync_text = `<b>Possible problems, last sync: <strong>${data[node]["lastsync"]}</strong></b>`
                    }

                    if (data[node]["region"]) {
                        region = data[node]["region"];
                    } else {
                        region = "Common";
                    }

                    if (mini_miner_http_status) {
                        mini_miner_http_status_icon = `<i class="has-text-success fa fa-check-circle"></i>`
                    } else {
                        mini_miner_http_status_icon = `<i class="has-text-danger fa fa-times-circle"></i>`
                    }

                    if (parseInt(data[node]["lastsync"]) < 3600) {
                        if (data[node]["name"] == "Mini miner proxy") {
                            node_column = (`
                                <div class="content p-3" style="min-width:200px">
                                    <p class="heading title mb-1 is-size-6">
                                        <i class="fa ${data[node]["icon"]}"></i>
                                        <span>Mini Miner proxies</span>
                                    </p>
                                    <div class="content">
                                        <a href="https://server.duinocoin.com/miniminer.html" target="_blank">
                                            HTTPS
                                        </a>
                                        <i class="${synccolor} fa ${syncicon}"></i>
                                        &nbsp;
                                        <a href="http://2.56.244.72/miniminer.html" target="_blank">
                                            HTTP
                                        </a>
                                        ${mini_miner_http_status_icon}
                                        <br>
                                        Clients: <strong>${data[node]["connections"]}</strong>
                                    </div>
                                </div>`);
                        } else {
                            node_column = (`
                                <div class="content p-3" style="min-width:200px">
                                    <p class="heading title mb-1 is-size-6">
                                        <i class="fa ${data[node]["icon"]}"></i>
                                        <span>${data[node]["name"].replaceAll("-", " ")}</span>
                                    </p>
                                    <div class="content">
                                        ${sync_text}
                                        <i class="${synccolor} fa ${syncicon}"></i>
                                        <br>
                                        CPU: <strong style="color:${cpucolor}">${data[node]["cpu"]}%</strong> RAM: <strong style="color:${ramcolor}">${data[node]["ram"]}%</strong><br>
                                        Clients: <strong>${data[node]["connections"]}</strong><br>
                                        ${node_type}
                                    </div>
                                </div>`);
                        }

                        if (data[node]["region"] == "EU") eu_html += node_column;
                        else if (data[node]["region"] == "AU") au_html += node_column;
                        else if (data[node]["region"] == "SA") sa_html += node_column;
                        else if (data[node]["region"] == "AS") as_html += node_column;
                        else if (data[node]["region"] == "NA") na_html += node_column;
                        else common_html += node_column;
                    }
                }

                if (common_html) {
                    node_html += (`<div class="column">
                                        <div class="panel">
                                            <p class="panel-heading heading">Common services</p>
                                            <div class="content m-3">
                                                <div class="columns is-multiline">
                                                    ${common_html}
                                                </div>
                                            </div>
                                        </div>
                                    </div>`);
                }

                if (eu_html) {
                    node_html += (`<div class="column is-full">
                                        <div class="panel">
                                            <p class="panel-heading heading">Europe servers</p>
                                            <div class="content m-3">
                                                <div class="columns is-multiline">
                                                    ${eu_html}
                                                </div>
                                            </div>
                                        </div>
                                    </div>`);
                }

                if (as_html) {
                    node_html += (`<div class="column is-half">
                                        <div class="panel">
                                            <p class="panel-heading heading">Asia servers</p>
                                            <div class="content m-3">
                                                <div class="columns is-multiline">
                                                    ${as_html}
                                                </div>
                                            </div>
                                        </div>
                                    </div>`);
                }

                if (sa_html) {
                    node_html += (`<div class="column is-half">
                                        <div class="panel">
                                            <p class="panel-heading heading">South America servers</p>
                                            <div class="content m-3">
                                                <div class="columns is-multiline">
                                                    ${sa_html}
                                                </div>
                                            </div>
                                        </div>
                                    </div>`);
                }

                if (na_html) {
                    node_html += (`<div class="column is-half">
                                        <div class="panel">
                                            <p class="panel-heading heading">North America servers</p>
                                            <div class="content m-3">
                                                <div class="columns is-multiline">
                                                    ${na_html}
                                                </div>
                                            </div>
                                        </div>
                                    </div>`)
                }

                if (au_html) {
                    node_html += (`<div class="column is-half">
                                        <div class="panel">
                                            <p class="panel-heading heading">Australia & Oceania servers</p>
                                            <div class="content m-3">
                                                <div class="columns is-multiline">
                                                    ${au_html}
                                                </div>
                                            </div>
                                        </div>
                                    </div>`);
                }

                update_element("pools", node_html);
            } else {
                common_html = `<div class="column">
                                    <div class="panel">
                                        <p class="panel-heading heading">Common services</p>
                                        <div class="content m-3">
                                            <div class="columns is-multiline">
                                                <div class="content m-3" style="min-width:200px">
                                                    <p class="heading title mb-1 is-size-6">
                                                        <i class="fa fa-link"></i>
                                                        Websites
                                                    </p>
                                                    <div class="content">
                                                        Operational <i class="fa fa-check-circle has-text-success"></i><br>
                                                        with <b class="icon-text" style="color:#F48121">
                                                            <img class="icon" src='https://upload.wikimedia.org/wikipedia/commons/9/94/Cloudflare_Logo.png'>

                                                            <span>Cloudflare</span>
                                                        </b>
                                                    </div>
                                                    <p class="heading title mb-1 is-size-6">
                                                        <i class="fa fa-cog"></i>
                                                        APIs
                                                    </p>
                                                    <div class="content has-text-weight-bold">
                                                        Possible problems <i class="fa fa-times-circle has-text-danger"></i><br>
                                                        Response time: <b>${end_time - start_time}ms</b>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>`;
                update_element("pools", common_html);
            }
        })
}

let mini_miner_http_status = false;

function update_http_proxy() {
    $.get("https://api.allorigins.win/raw?url=http://2.56.244.72/miniminer.html?v=" + new Date(), )
      .done(function(data) {
        mini_miner_http_status = true;
      })
      .fail(function(jqxhr, textStatus, error ) {
        var err = textStatus + ", " + error;
        mini_miner_http_status = false;
        console.log( "Mini miner is down: " + err );
    });
}

update_stats();
window.setInterval(update_stats, 5000);

update_ws_proxy();
window.setInterval(update_ws_proxy, 10000);

update_http_proxy();
window.setInterval(update_http_proxy, 5000);

last_explorer_hashes();
window.setInterval(last_explorer_hashes, 5000);

update_pools();
window.setInterval(update_pools, 3000);

fetch_price();

$("#search_input").on('keydown', function(e) {
    if (e.which === 13) {
        e.preventDefault();
        button_search();
    }
});

function button_search() {
    to_search = $('#search_input').val().escape();
    console.log("Button search for ", to_search.escape())
    search(to_search.escape());
}

function link_search(to_search) {
    console.log("Link search for ", to_search.escape())
    search(to_search.escape());
}

if (to_search) search(to_search.escape());


/* On page loaded */
$(window).on('load', function() {
    const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
    if ($navbarBurgers.length > 0) {
        $navbarBurgers.forEach(el => {
            el.addEventListener('click', () => {
                const target = el.dataset.target;
                const $target = document.getElementById(target);
                el.classList.toggle('is-active');
                $target.classList.toggle('is-active');
            });
        });
    }
    $("#pageloader").fadeOut();
});
</script>

</html>
